<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.111.3">
    <meta name="generator" content="Relearn 5.17.1+tip">
    <meta name="description" content="Linux, Tech, Open Source Software, Privacy">
    <meta name="author" content="David">
    <title>Device Management Protocols - Perfect Dark Mode</title>
    <link href="http://perfectdarkmode.com/networking/cisco/device_management_protocols/index.html" rel="canonical" type="text/html" title="Device Management Protocols - Perfect Dark Mode">
    <link href="/networking/cisco/device_management_protocols/index.xml" rel="alternate" type="application/rss+xml" title="Device Management Protocols - Perfect Dark Mode">
    <link href="/images/favicon.png?1700252831" rel="icon" type="image/png">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/css/fontawesome-all.min.css?1700252831" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1700252831" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1700252831" rel="stylesheet">
    <link href="/css/auto-complete.css?1700252831" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1700252831" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1700252831" rel="stylesheet">
    <link href="/css/fonts.css?1700252831" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1700252831" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1700252831" rel="stylesheet">
    <link href="/css/theme-city2.css?1700252831" rel="stylesheet" id="variant-style">
    <link href="/css/variant.css?1700252831" rel="stylesheet">
    <link href="/css/print.css?1700252831" rel="stylesheet" media="print">
    <link href="/css/format-print.css?1700252831" rel="stylesheet">
    <link href="/css/ie.css?1700252831" rel="stylesheet">
    <script src="/js/url.js?1700252831"></script>
    <script src="/js/variant.js?1700252831"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='http:\/\/perfectdarkmode.com/';
      window.variants && variants.init( [ 'city2' ] );
    </script>
  </head>
  <body class="mobile-support print" data-url="/networking/cisco/device_management_protocols/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable">
        <div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" class="topbar-link" title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/index.html"><span itemprop="name">Perfect Dark Mode</span></a><meta itemprop="position" content="1"> &gt; </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Device Management Protocols</span><meta itemprop="position" content="2"></li>
            </ol>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="device-management-protocols">Device Management Protocols</h1>

<p>2.0 Network Access</p>
<p>2.3 Configure and verify Layer 2 discovery protocols (Cisco Discovery Protocol and LLDP)</p>
<p>4.0 IP Services</p>
<p>4.2 Configure and verify NTP operating in a client and server mode</p>
<p>4.5 Describe the use of syslog features including facilities and levels</p>
<h1 id="system-message-logging-syslog">System Message Logging (Syslog)</h1>
<p>Sending Messages in Real Time to Current Users</p>
<ul>
<li>
<p>Telnet and SSH users, the device requires a two-step process before the user sees the messages.</p>
</li>
<li>
<p>global configuration setting—logging monitor—tells IOS to enable the sending of log messages to all logged users.</p>
</li>
<li>
<p>must also issue the terminal monitor EXEC command during the login session, which tells IOS that this terminal session would like to receive log messages.
ogging console<br>
Console<br>
logging monitor</p>
</li>
<li>
<p>IOS -<br>
terminal monitor<br>
(NO Messages)<br>
Figure 9-1 IOS Processing for Log Messages to Current Users &ldquo;&gt;</p>
</li>
</ul>
<p>Storing Log Messages for Later Review</p>
<p>two primary means to keep a copy</p>
<ul>
<li>can store copies of the log messages in RAM by virtue of the logging buffered global configuration command.</li>
</ul>
<p>any user can come back later and see the old log messages by using the show logging EXEC command.</p>
<p>store log messages centrally to a syslog server.</p>
<p>syslog protocol - a UDP protocol to send messages to a syslog server for storage</p>
<p>To configure a router or switch to send log messages to a syslog server, add the logging host {address | hostname } global command</p>
<p>
<a href="#image-ed6847dec1ab2fbec443d579a2f79580" class="lightbox-link">
<img src="/networking/cisco/device_management_protocols/Pasted%20image%2020230120151144.png" alt="Pasted image 20230120151144.png" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-ed6847dec1ab2fbec443d579a2f79580">
<img src="/networking/cisco/device_management_protocols/Pasted%20image%2020230120151144.png" alt="Pasted image 20230120151144.png" class="lightbox-image" loading="lazy">
</a></p>
<p>Log Message Format</p>
<p>*Dec 18 17:10:15.079: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to down</p>
<p>A timestamp: *Dec 18 17:10:15.079</p>
<p>The facility on the router that generated the message: %LINEPROTO</p>
<p>The severity level: 5</p>
<p>A mnemonic for the message: UPDOWN</p>
<p>The description of the message: Line protocol on Interface FastEthernet0/0, changed state to down</p>
<p>you can at least toggle on and off the use of the timestamp (which is included by default) and a log message sequence number (which is not enabled by default). Example 9-1 reverses those defaults by turning off timestamps and turning on sequence numbers.</p>
<p>Example 9-1 Disabling Timestamps and Enabling Sequence Numbers in Log
Wessages
Click here to view code image
Rl(config)# no service timestamps
Rl(config)# service sequence-numbers
Rl(config)# end
000011: %SYS-5-CONFIG I: Configured from console by console</p>
<p>Log Message Severity Levels</p>
<p>the lower the number, the more severe the event that caused the message.</p>
<p>
<a href="#image-562a160c7539625179b1d8ac6981d348" class="lightbox-link">
<img src="blob:file:///980bce15-c623-489b-bd14-11e70f4fffc2" alt="Keyword
Emergency
Alert
Critical
Error
Warning
Notification
Informational
Debug
Numeral
2
3
4
5
6
7
Description
System unusable
Immediate action required
Critical Event (Highest Of 3)
Error Event (Middle Of 3)
Warning Event (Lowest Of 3)
Normal, More Important
Normal, Less Important
Requested by User Debug
Impactful
Normal
Debug
Figure 9-3 Syslog Message Severity Levels by Keyword and Numeral" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-562a160c7539625179b1d8ac6981d348">
<img src="blob:file:///980bce15-c623-489b-bd14-11e70f4fffc2" alt="Keyword
Emergency
Alert
Critical
Error
Warning
Notification
Informational
Debug
Numeral
2
3
4
5
6
7
Description
System unusable
Immediate action required
Critical Event (Highest Of 3)
Error Event (Middle Of 3)
Warning Event (Lowest Of 3)
Normal, More Important
Normal, Less Important
Requested by User Debug
Impactful
Normal
Debug
Figure 9-3 Syslog Message Severity Levels by Keyword and Numeral" class="lightbox-image" loading="lazy">
</a></p>
<p>last level in the figure is used for messages requested by the debug command</p>
<p>Table 9-2 summarizes the configuration commands used to enable logging and to set the severity level for each type.</p>
<p>For example, the command logging console 4 causes IOS to send severity level 0–4 messages to the console</p>
<p>
<a href="#image-2505c9f14ea9d605ad8a4dff683a39b5" class="lightbox-link">
<img src="blob:file:///b598183b-1e6d-47a2-bd46-61cdb8416e46" alt="Table 9-2 How to Configure Logging Message Levels for Each Log Service
Key
Topic
Service
Console
Monitor
Buffered
Syslog
To Enable Logging
logging console
logging monitor
logging buffered
logging host address I
hostname
To Set Message Levels
logging console level-name I level-
number
logging monitor level-name I
level-number
logging buffered level-name I
level-number
logging trap level-name I level-
number" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-2505c9f14ea9d605ad8a4dff683a39b5">
<img src="blob:file:///b598183b-1e6d-47a2-bd46-61cdb8416e46" alt="Table 9-2 How to Configure Logging Message Levels for Each Log Service
Key
Topic
Service
Console
Monitor
Buffered
Syslog
To Enable Logging
logging console
logging monitor
logging buffered
logging host address I
hostname
To Set Message Levels
logging console level-name I level-
number
logging monitor level-name I
level-number
logging buffered level-name I
level-number
logging trap level-name I level-
number" class="lightbox-image" loading="lazy">
</a></p>
<p>Configuring and Verifying System Logging</p>
<p>
<a href="#image-47162fd4da5acc6fb60f4031568fc233" class="lightbox-link">
<img src="blob:file:///441c47eb-3766-4f0d-8251-7181b1dd2aee" alt="172.16.1.0/24
172.16.1.1
GO/I
RI
17216.21
GO/2
172.162.2
172.16.3.0/24
SW2
172.16.3.9
Figure 9-4 Sample Network Used in Logging Examples" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-47162fd4da5acc6fb60f4031568fc233">
<img src="blob:file:///441c47eb-3766-4f0d-8251-7181b1dd2aee" alt="172.16.1.0/24
172.16.1.1
GO/I
RI
17216.21
GO/2
172.162.2
172.16.3.0/24
SW2
172.16.3.9
Figure 9-4 Sample Network Used in Logging Examples" class="lightbox-image" loading="lazy">
</a></p>
<p>
<a href="#image-a9c4f0d9d24e209658ac252ab95e112f" class="lightbox-link">
<img src="blob:file:///89cbe1a2-0745-46e2-923a-30bb5f816e43" alt="Example 9-2 Syslog Configuration on RI
Click here to view code image
logging
logging
logging
logging
logging
console 7
monitor debug
buffered 4
host 172.16.3.9
trap warning" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-a9c4f0d9d24e209658ac252ab95e112f">
<img src="blob:file:///89cbe1a2-0745-46e2-923a-30bb5f816e43" alt="Example 9-2 Syslog Configuration on RI
Click here to view code image
logging
logging
logging
logging
logging
console 7
monitor debug
buffered 4
host 172.16.3.9
trap warning" class="lightbox-image" loading="lazy">
</a></p>
<p>the example configures the same message level at the console and for terminal monitoring (level 7, or debug), and the same level for both buffered and logging to the syslog server (level 4, or warning). The levels may be set using the numeric severity level or the name as shown earlier in Figure 9-3.</p>
<p>show logging command confirms those same configuration settings and also lists the log messages per the logging buffered configuration.</p>
<p>
<a href="#image-0b4ece62f4431a8affdd5357554bdca4" class="lightbox-link">
<img src="blob:file:///09d59061-71bc-43e6-a415-cca2e3f9e5a8" alt="Example 9-3 Viewing the Configured Log Settings per the Earlier Example
Click here to view code image
Rl# show logging
Syslog logging: enabled (0 messages dropped,
No Active Message Discriminator.
No Inactive Message Discriminator.
3 messages rate-limited
Console logging: level debugging, 45 messages logged, xml disabl
filtering disabled
Monitor logging: level debugging, 0 messages logged, xml disable
filtering disabled
Buffer logging: level warnings, e messages logged, xml disabled,
filtering disabled
Exception Logging: size (8192 bytes)
Count and timestamp logging messages:
Persistent logging: disabled
disabled" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-0b4ece62f4431a8affdd5357554bdca4">
<img src="blob:file:///09d59061-71bc-43e6-a415-cca2e3f9e5a8" alt="Example 9-3 Viewing the Configured Log Settings per the Earlier Example
Click here to view code image
Rl# show logging
Syslog logging: enabled (0 messages dropped,
No Active Message Discriminator.
No Inactive Message Discriminator.
3 messages rate-limited
Console logging: level debugging, 45 messages logged, xml disabl
filtering disabled
Monitor logging: level debugging, 0 messages logged, xml disable
filtering disabled
Buffer logging: level warnings, e messages logged, xml disabled,
filtering disabled
Exception Logging: size (8192 bytes)
Count and timestamp logging messages:
Persistent logging: disabled
disabled" class="lightbox-image" loading="lazy">
</a></p>
<p>
<a href="#image-d1f68268ba5e5c91fad218fd70f80998" class="lightbox-link">
<img src="blob:file:///b920da0f-adeb-4912-8aeb-78422dee63af" alt="No active filter modules.
Trap logging: level warnings, e message lines logged
Logging to 172.16.3.9 (udp port 514, audit disabled,
link up),
0 message lines logged,
0 message lines rate-limited,
0 message lines dropped-by-MD,
xml disabled, sequence number disabled
filtering disabled
Logging Source-Interface:
Log Buffer (8192 bytes):
VRF Name:" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-d1f68268ba5e5c91fad218fd70f80998">
<img src="blob:file:///b920da0f-adeb-4912-8aeb-78422dee63af" alt="No active filter modules.
Trap logging: level warnings, e message lines logged
Logging to 172.16.3.9 (udp port 514, audit disabled,
link up),
0 message lines logged,
0 message lines rate-limited,
0 message lines dropped-by-MD,
xml disabled, sequence number disabled
filtering disabled
Logging Source-Interface:
Log Buffer (8192 bytes):
VRF Name:" class="lightbox-image" loading="lazy">
</a></p>
<p>If any log messages had been buffered, the actual log messages would be listed at the end of the command</p>
<p>clear out the old messages from the log with the clear logging EXEC command.</p>
<dl>
<dt>![Rl# configure terminal</dt>
<dt>Enter configuration commands,</dt>
<dt>RI (config)# interface gø/l</dt>
<dt>RI (config-if)# shutdown</dt>
<dt>RI</dt>
<dt>one per line.</dt>
<dt>End with CNTL/Z.</dt>
<dt>*Oct 21 %LINK-5-CHANGED: Interface GigabitEthernetO/1,</dt>
<dt>*Oct 21 %LINEPROTO-5-UPDOWN: Line protocol on Interfac</dt>
<dt>RI (config-if)# no shutdown</dt>
<dt>RI</dt>
<dt>*Oct 21</dt>
<dd>%LINK-3-UPDOWN: Interface GigabitEthernetØ/1,
*Oct 21 %LINEPROTO-5-UPDOWN: Line protocol on Interfac
RI (config-if)# AZ
*Oct 21</dd>
<dd>%SYS-5-CONFIG I: Configured from console by co
Rl# show logging
! Skipping about 20 lines, the same lines in Example 9-3,
until the
Log Buffer (8192 bytes) :
*Oct 21 %LINK-3-UPDOWN:
Interface GigabitEthernetØ/1,](blob:file:///50a65acc-0691-4338-a954-5e888ca303e9)</dd>
</dl>
<p>The debug Command and Log Messages</p>
<p>debug EXEC command gives the network engineer a way to ask IOS to monitor for certain internal events, with that monitoring process continuing over time, so that IOS can issue log messages when those events occur</p>
<p>debug remains active until some user issues the no debug command with the same parameters, disabling the debug.</p>
<p>
<a href="#image-11ba3016f53ffc08f8bc7b3ba5c7f6ee" class="lightbox-link">
<img src="blob:file:///0a51c53d-835e-4dcd-ae27-8ad10d86b942" alt="Example 9-5 Using debug ip ospf hello from RI&amp;rsquo;s Console
Click here to view code image
Rl# debug ip ospf hello
OSPF
*Aug
*Aug
*Aug
hello
IS on
10 OSPF-I HELLO GiØ/1:
10 OSPF-I HELLO GiØ/2:
10 OSPF-I HELLO GiØ/2:
debuggi ng
Send hello to 224.Ø.Ø.5 area
Rcv hello from 2.2.2.2 area
Send hello to 224.0.0.5 area" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-11ba3016f53ffc08f8bc7b3ba5c7f6ee">
<img src="blob:file:///0a51c53d-835e-4dcd-ae27-8ad10d86b942" alt="Example 9-5 Using debug ip ospf hello from RI&amp;rsquo;s Console
Click here to view code image
Rl# debug ip ospf hello
OSPF
*Aug
*Aug
*Aug
hello
IS on
10 OSPF-I HELLO GiØ/1:
10 OSPF-I HELLO GiØ/2:
10 OSPF-I HELLO GiØ/2:
debuggi ng
Send hello to 224.Ø.Ø.5 area
Rcv hello from 2.2.2.2 area
Send hello to 224.0.0.5 area" class="lightbox-image" loading="lazy">
</a></p>
<p>anyone logged in with SSH at the time Example 9-4’s output was gathered would not have seen the output, even with the logging monitor debug command configured on router R1, without first issuing a terminal monitor command.</p>
<p>all enabled debug options use router CPU, which can cause problems for the router. You can monitor CPU use with the show process cpu command</p>
<p>use caution when using debug commands carefully on production devices.</p>
<p>the more CLI users that receive debug messages, the more CPU that is consumed.</p>
<h2 id="network-time-protocol-ntp">Network Time Protocol (NTP)</h2>
<p>Devices send timestamps to each other with NTP messages, continually exchanging messages, with one device changing its clock to match the other, eventually synchronizing the clocks.</p>
<p>How NTP defines the sources of time data (reference clocks) and how good each time source is (stratum).</p>
<p>Setting the Time and Timezone</p>
<p>NTP works best if you set the device clock to a reasonably close time before enabling the NTP client function with the ntp server command</p>
<p>I should set the time to 8:52 p.m., set the correct date and timezone, and even tell the device to adjust for daylight savings time—and then enable NTP</p>
<p>Example 9-7 shows how to set the date, time, timezone, and daylight savings time.</p>
<p>
<a href="#image-a8131f083cef29502165931801039f4b" class="lightbox-link">
<img src="blob:file:///12712855-da00-4f5f-9301-b908790790c9" alt="Example 9-7 Setting the Date/Time with clock set, Plus Timezone/DST
Click here to view code image
Rl# configure terminal
Enter configuration commands, one per line. End with CNTL/Z.
RI (config)# clock timezone EST -5
RI clock summer-time EDT recurring
RI (config)# AZ
clock set 21 October 2ø15
*Oct 21 me: %SYS-6-CLOCKUPDATE:
System clock has been upda
Rl# show clock
EDT Wed
Oct 21 2015" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-a8131f083cef29502165931801039f4b">
<img src="blob:file:///12712855-da00-4f5f-9301-b908790790c9" alt="Example 9-7 Setting the Date/Time with clock set, Plus Timezone/DST
Click here to view code image
Rl# configure terminal
Enter configuration commands, one per line. End with CNTL/Z.
RI (config)# clock timezone EST -5
RI clock summer-time EDT recurring
RI (config)# AZ
clock set 21 October 2ø15
*Oct 21 me: %SYS-6-CLOCKUPDATE:
System clock has been upda
Rl# show clock
EDT Wed
Oct 21 2015" class="lightbox-image" loading="lazy">
</a></p>
<p>You should set the first two commands before setting the time of day with the clock set EXEC command because the two configuration commands impact the time that is set.</p>
<p>chose EDT because it is the acronym for daylight savings time in that same EST time zone. Finally, the recurring keyword tells the router to spring forward an hour and fall back an hour automatically over the years.</p>
<p>clock set EXEC command</p>
<p>uses a time syntax with a 24-hour format, not with a 12-hour format plus a.m./p.m.).</p>
<p>The show clock command (issued seconds later) lists that time, but also notes the time as EDT, rather than UTC time.</p>
<p>Basic NTP Configuration</p>
<p>two ntp configuration commands</p>
<p>ntp master {stratum-level}: NTP server mode—the device acts only as an NTP server, and not as an NTP client. The device gets its time information from the internal clock on the device.</p>
<p>ntp server {address | hostname} : NTP client/server mode—the device acts as both client and server. First, it acts as an NTP client, to synchronize time with a server. Once synchronized, the device can then act as an NTP server, to supply time to other NTP clients.</p>
<p>
<a href="#image-6795d9c229bd4b7b4efaa182c8f19b08" class="lightbox-link">
<img src="blob:file:///ad94907d-f81d-499c-ad54-b5db7eb548e3" alt="ntp server 172.162.2
NTP Client/ server
Stratum 4
ntp server 172.16.3.3
NTP Client / server
Stratum 3
172.16.3_3
GOII
Mp master
GO,&amp;lsquo;2
NTP server
Stratum 2
Figure 9-5 RI as NTP Client, R2 as Client/Server, R3 as Server" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-6795d9c229bd4b7b4efaa182c8f19b08">
<img src="blob:file:///ad94907d-f81d-499c-ad54-b5db7eb548e3" alt="ntp server 172.162.2
NTP Client/ server
Stratum 4
ntp server 172.16.3.3
NTP Client / server
Stratum 3
172.16.3_3
GOII
Mp master
GO,&amp;lsquo;2
NTP server
Stratum 2
Figure 9-5 RI as NTP Client, R2 as Client/Server, R3 as Server" class="lightbox-image" loading="lazy">
</a></p>
<p>
<a href="#image-f0dbeeebeb3c4a9c6357e4ad95277e10" class="lightbox-link">
<img src="blob:file:///643a88fe-2d60-4ee1-9684-09c87d798ae2" alt="Example 9-8 NTP Client/Server Configuration
Click here to view code image
! Configuration on RI:
ntp server 172.16.2.2
Click here to view code image
! Configuration on R2:
ntp server 172.16.3.3
Click here to view code image
! Configuration on R3:
ntp master 2" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-f0dbeeebeb3c4a9c6357e4ad95277e10">
<img src="blob:file:///643a88fe-2d60-4ee1-9684-09c87d798ae2" alt="Example 9-8 NTP Client/Server Configuration
Click here to view code image
! Configuration on RI:
ntp server 172.16.2.2
Click here to view code image
! Configuration on R2:
ntp server 172.16.3.3
Click here to view code image
! Configuration on R3:
ntp master 2" class="lightbox-image" loading="lazy">
</a></p>
<p>show ntp status command</p>
<p>lists a status of synchronized, which confirms the NTP client has completed the process of changing its time to match the server’s time. Any router acting as an NTP client will list “unsynchronized” in that first line until the NTP synchronization process completes with at least one server. It also confirms the IP address of the server—this device’s reference clock—with the IP address configured in Example 9-8 (172.16.2.2).</p>
<p>
<a href="#image-2e085d352a2282313964db599679164e" class="lightbox-link">
<img src="blob:file:///43b9da43-57f0-4a98-a836-4e093bd06ef3" alt="Example 9-9 Verifying NTP Client Status on RI
Click here to view code image
Rl# show ntp status
Clock is synchronized, stratum 4, reference is 172.16.2.2
nominal freq is 250.0000 Hz, actual freq is 250.0000 Hz, precision is
ntp uptime is 1553800 (1/100 of seconds), resolution is 4000
reference time is DA5E7147.56CADEA7 (19:54:31.339 EST Thu Feb 4 2016)
clock offset is 0.0986 msec, root delay is 2.46 msec
root dispersion is 22.19 msec, peer dispersion is 5.33 msec
loopfilter state is &amp;lsquo;CTRL &amp;rsquo;
system poll interval is 64,
(Normal Controlled Loop), drift is e. 000000G
last update was 530 sec ago." style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-2e085d352a2282313964db599679164e">
<img src="blob:file:///43b9da43-57f0-4a98-a836-4e093bd06ef3" alt="Example 9-9 Verifying NTP Client Status on RI
Click here to view code image
Rl# show ntp status
Clock is synchronized, stratum 4, reference is 172.16.2.2
nominal freq is 250.0000 Hz, actual freq is 250.0000 Hz, precision is
ntp uptime is 1553800 (1/100 of seconds), resolution is 4000
reference time is DA5E7147.56CADEA7 (19:54:31.339 EST Thu Feb 4 2016)
clock offset is 0.0986 msec, root delay is 2.46 msec
root dispersion is 22.19 msec, peer dispersion is 5.33 msec
loopfilter state is &amp;lsquo;CTRL &amp;rsquo;
system poll interval is 64,
(Normal Controlled Loop), drift is e. 000000G
last update was 530 sec ago." class="lightbox-image" loading="lazy">
</a></p>
<p>show ntp associations</p>
<p>lists all the NTP servers that the local device can attempt to use, with status information about the association between the local device (client) and the various NTP servers.</p>
<p>Status on RI and R2<br>
Click here to view code image<br>
RI# show ntp associations<br>
! This output is<br>
taken from router RI, acting in client/server mode<br>
address<br>
sys . peer ,<br>
ref<br>
clock<br>
172.16. 3.3</p>
<h1 id="selected">selected,</h1>
<p>st<br>
3<br>
when poll<br>
50<br>
64</p>
<ul>
<li>candidate,<br>
reach<br>
377<br>
outlyer ,<br>
delay offset<br>
1.223 0.090<br>
x falseticker,<br>
disp<br>
4.46f<br>
cor<br>
Click here to view code image<br>
R2# show ntp associations<br>
! This output is taken from router R2, acting in<br>
client/server mode<br>
address<br>
ref clock<br>
1<br>
st<br>
2<br>
when poll<br>
49<br>
64<br>
reach<br>
377<br>
outlyer,<br>
delay<br>
1.220<br>
offset<br>
-7.758<br>
disp<br>
3.69<br>
*A-172.16.3.3 127.127.1.<br>
sys .peer, # selected,<br>
candidate,<br>
x<br>
falseticker, &ldquo;&gt;</li>
</ul>
<h3 id="ntp-reference-clock-and-stratum">NTP Reference Clock and Stratum</h3>
<p>Devices that act solely as an NTP server get their time from either internal device hardware or from some external clock using mechanisms other than NTP.</p>
<p>NTP servers and clients use a number to show the perceived accuracy of their reference clock data based on stratum level. The lower the stratum level, the more accurate the reference clock is considered to be. An NTP server that uses its internal hardware or external reference clock sets its own stratum level. Then, an NTP client adds 1 to the stratum level it learns from its NTP server, so that the stratum level increases the more hops away from the original clock source.</p>
<p>For instance, back in Figure 9-5, you can see the NTP primary server (R3) with a stratum of 2. R2, which references R3, adds 1 so it has a stratum of 3. R1 uses R2 as its NTP server, so R1 adds 1 to have a stratum of 4. These increasing stratum levels allow devices to refer to several NTP servers and then use time information from the best NTP server, best being the server with the lowest stratum level.</p>
<p>Routers and switches use the default stratum level of 8 for their internal reference clock based on the default setting of 8 for the stratum level in the ntp master [stratum-level] command. The command allows you to set a value from 1 through 15; in Example 9-8, the ntp master 2 command set router R3’s stratum level to 2.</p>
<p>Note</p>
<p>NTP considers 15 to be the highest useful stratum level, so any devices that calculate their stratum as 16 consider the time data unusable and do not trust the time. So, avoid setting higher stratum values on the ntp master command.</p>
<p>
<a href="#image-c8745e37c6497680a684d9e4bc6bb9bb" class="lightbox-link">
<img src="blob:file:///f789da20-724e-41ae-9ebd-7fe1c5ef7c68" alt="Example 9-11 Examining NTP Server, Reference Clock, and Stratum Data
Click here to view code image
R3# show ntp status
Clock is synchronized, stratum 2, reference is 127.127.1.1
nominal freq is 250.0000 Hz, actual freq is 250.0000 Hz, precision i
ntp uptime is 595300 (1/100 of seconds), resolution is 4000
reference time is EOF9174C.87277EBB (16:13:32.527 daylight sat Aug 1
clock offset is 0.0000 msec, root delay is 0.00 msec
root dispersion is 0.33 msec, peer dispersion is 0.23 msec
loopfilter state is &amp;lsquo;CTRL&amp;rsquo; (Normal Controlled Loop), drift is e. 00001
system poll interval is 16, last update was 8 sec ago.
R3# show ntp associations
address
*n.127 • 127 • 1.1
ref clock
. LOCL
st
1
when
15
poll
16
reach delay
377 0.øoe
falseticker,
off
o.
sys .peer, # selected, &#43; candidate,
outlyer, x" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-c8745e37c6497680a684d9e4bc6bb9bb">
<img src="blob:file:///f789da20-724e-41ae-9ebd-7fe1c5ef7c68" alt="Example 9-11 Examining NTP Server, Reference Clock, and Stratum Data
Click here to view code image
R3# show ntp status
Clock is synchronized, stratum 2, reference is 127.127.1.1
nominal freq is 250.0000 Hz, actual freq is 250.0000 Hz, precision i
ntp uptime is 595300 (1/100 of seconds), resolution is 4000
reference time is EOF9174C.87277EBB (16:13:32.527 daylight sat Aug 1
clock offset is 0.0000 msec, root delay is 0.00 msec
root dispersion is 0.33 msec, peer dispersion is 0.23 msec
loopfilter state is &amp;lsquo;CTRL&amp;rsquo; (Normal Controlled Loop), drift is e. 00001
system poll interval is 16, last update was 8 sec ago.
R3# show ntp associations
address
*n.127 • 127 • 1.1
ref clock
. LOCL
st
1
when
15
poll
16
reach delay
377 0.øoe
falseticker,
off
o.
sys .peer, # selected, &#43; candidate,
outlyer, x" class="lightbox-image" loading="lazy">
</a></p>
<h3 id="redundant-ntp-configuration">Redundant NTP Configuration</h3>
<p>an enterprise could use NTP to reference NTP servers that use an atomic clock as their reference source, like the NTP primary servers in Figure 9-6, which happen to be run by the US National Institute of Standards and Technology (NIST) (see tf.nist.gov).</p>
<p>
<a href="#image-183ec74f61a4e3ca49307115cfa22234" class="lightbox-link">
<img src="blob:file:///b0dca087-9689-487e-86ec-04b89f2d82ee" alt="Stratum 1
Stratum 2
NTP Primary
servers (MST)
Internet
NTP Clienvserver
Stratum 3
9-6 Stratum Levels VVhen Using an Internet-based Stratum 1 NTP Server" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-183ec74f61a4e3ca49307115cfa22234">
<img src="blob:file:///b0dca087-9689-487e-86ec-04b89f2d82ee" alt="Stratum 1
Stratum 2
NTP Primary
servers (MST)
Internet
NTP Clienvserver
Stratum 3
9-6 Stratum Levels VVhen Using an Internet-based Stratum 1 NTP Server" class="lightbox-image" loading="lazy">
</a></p>
<p>NTP primary server and NTP secondary server.</p>
<p>An NTP primary server acts only as a server, with a reference clock external to the device, and has a stratum level of 1, like the two NTP primary servers shown in Figure 9-6. NTP secondary servers are servers that use client/server mode as described throughout this section, relying on synchronization with some other NTP server.</p>
<p>
<a href="#image-8c78ddb226ddd6303a222b01dba078ce" class="lightbox-link">
<img src="blob:file:///77c1af69-5be5-421e-983f-f15baed94077" alt="Example 9-12 NTP Configuration on RI, R2 per Eigure 9-6
Click here to view code image
ntp server time-a-b-nist .gov
ntp server time-a-g.nist.gov" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-8c78ddb226ddd6303a222b01dba078ce">
<img src="blob:file:///77c1af69-5be5-421e-983f-f15baed94077" alt="Example 9-12 NTP Configuration on RI, R2 per Eigure 9-6
Click here to view code image
ntp server time-a-b-nist .gov
ntp server time-a-g.nist.gov" class="lightbox-image" loading="lazy">
</a></p>
<p>After losing their reference clock, R1 and R2 could no longer be useful NTP servers to the rest of the enterprise.</p>
<p>To overcome this potential issue, the routers can also be configured with the ntp master command, resulting in this logic:</p>
<p>Establish an association with the NTP servers per the ntp server command.</p>
<p>Establish an association with your internal clock using the ntp master stratum command.</p>
<p>Set the stratum level of the internal clock (per the ntp master {stratum-level} command) to a higher (worse) stratum level than the Internet-based NTP servers.</p>
<p>Synchronize with the best (lowest) known time source, which will be one of the Internet NTP servers in this scenario</p>
<p>ntp master 7 command, with a much higher stratum,</p>
<p>
<a href="#image-e63c070462a914de38a383e8b83dce1e" class="lightbox-link">
<img src="blob:file:///6679839f-8a17-4d63-a07f-e4e09cda1598" alt="Example 9-13 NTP Configuration on RI and R2 to Protect Against Internet
Failures
Click here to view code image
ntp server time-a-b-nist .gov
ntp server time-a-g.nist.gov
ntp master 7" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-e63c070462a914de38a383e8b83dce1e">
<img src="blob:file:///6679839f-8a17-4d63-a07f-e4e09cda1598" alt="Example 9-13 NTP Configuration on RI and R2 to Protect Against Internet
Failures
Click here to view code image
ntp server time-a-b-nist .gov
ntp server time-a-g.nist.gov
ntp master 7" class="lightbox-image" loading="lazy">
</a></p>
<h3 id="ntp-using-a-loopback-interface-for-better-availability">NTP Using a Loopback Interface for Better Availability</h3>
<p>what happens when one interface on R4 fails</p>
<p>for any NTP clients that had referred to that specific IP address</p>
<p>There would likely still be a route to reach R4 itself.</p>
<p>The NTP client would not be able to send packets to the configured address because that interface is down.</p>
<p>
<a href="#image-f5022d76879fbcbc09f37569f5bf613b" class="lightbox-link">
<img src="blob:file:///efe7ee03-a9b4-4d2e-ad83-ba6db3b913a7" alt="R2
NTP server
Figure 9-7 The Availability Issue ofReferencing an NTP Server&amp;rsquo;s Physical Interface IP Address" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-f5022d76879fbcbc09f37569f5bf613b">
<img src="blob:file:///efe7ee03-a9b4-4d2e-ad83-ba6db3b913a7" alt="R2
NTP server
Figure 9-7 The Availability Issue ofReferencing an NTP Server&amp;rsquo;s Physical Interface IP Address" class="lightbox-image" loading="lazy">
</a></p>
<p>loopback interface to meet that exact need</p>
<p>once configured, it remains in an up/up state as long as</p>
<p>Key Topic.</p>
<p>The router remains up.</p>
<p>You do not issue a shutdown command on that loopback interface.</p>
<p>
<a href="#image-9ca53d7863a5a33295125567d3972801" class="lightbox-link">
<img src="blob:file:///46fedc78-dcd4-46c6-86d5-61d91857c93b" alt="Example 9-14 NTP Client/Server Configuration on RI and R2 Using a Loopback
Interface
Click here to view code image
! Configuration on RI,
ntp server 172.16.9.9
Click here to view code image
a client
! Configuration on R2 for its server function
interface loopback ø
L
ip address 172.16.9.9 255.255.255.ø
ntp master 4
ntp source loopback
! Verification on router R2
R2# show interfaces loopback ø
Loopback0 is up, line protocol is up
Hardware is Loopback" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-9ca53d7863a5a33295125567d3972801">
<img src="blob:file:///46fedc78-dcd4-46c6-86d5-61d91857c93b" alt="Example 9-14 NTP Client/Server Configuration on RI and R2 Using a Loopback
Interface
Click here to view code image
! Configuration on RI,
ntp server 172.16.9.9
Click here to view code image
a client
! Configuration on R2 for its server function
interface loopback ø
L
ip address 172.16.9.9 255.255.255.ø
ntp master 4
ntp source loopback
! Verification on router R2
R2# show interfaces loopback ø
Loopback0 is up, line protocol is up
Hardware is Loopback" class="lightbox-image" loading="lazy">
</a></p>
<p>
<a href="#image-2096c130f7329e7c3c57b71d3e2c29d4" class="lightbox-link">
<img src="blob:file:///a0215c7c-df76-4921-8d73-7d5d7b11785c" alt="Internet address is 172.16.9.9/24
! lines omitted for brevity" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-2096c130f7329e7c3c57b71d3e2c29d4">
<img src="blob:file:///a0215c7c-df76-4921-8d73-7d5d7b11785c" alt="Internet address is 172.16.9.9/24
! lines omitted for brevity" class="lightbox-image" loading="lazy">
</a></p>
<h2 id="analyzing-topology-using-cdp-and-lldp">Analyzing Topology Using CDP and LLDP</h2>
<h3 id="examining-information-learned-by-cdp">Examining Information Learned by CDP</h3>
<p>Cisco-proprietary</p>
<p>Layer 2 protocol</p>
<p>does not rely on a working Layer 3 protocol</p>
<p>Devices that support CDP learn information about others by listening for the advertisements sent by other devices.</p>
<p>CDP discovers several useful details from the neighboring Cisco devices:</p>
<p>Device identifier: Typically the host name</p>
<p>Address list: Network and data-link addresses</p>
<p>Port identifier: The interface on the remote router or switch on the other end of the link that sent the CDP advertisement</p>
<p>Capabilities list: Information on what type of device it is (for example, a router or a switch)</p>
<p>Platform: The model and OS level running on the device</p>
<p>Cisco IP Phones use CDP to learn the data and voice VLAN IDs as configured on the access switch.</p>
<p>
<a href="#image-e494a22b3ab4e860e8ef7f9602ad9def" class="lightbox-link">
<img src="blob:file:///2398a655-1078-49a1-bd8e-0103fbbca8ff" alt="Table 9-3 show cdp Commands That List Information About Neighbors
Command
show cdp neigh-
bors [type number]
show cdp neigh-
bors detail
show cdp entry
name
Description
Lists one summary line of information about each
neighbor or just the neighbor found on a specific inter-
face if an interface was listed
Lists one large set (approximately 15 lines) of informa-
tion, one set for every neighbor
Lists the same information as the show cdp neighbors
detail command, but only for the named neighbor
(case sensitive)" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-e494a22b3ab4e860e8ef7f9602ad9def">
<img src="blob:file:///2398a655-1078-49a1-bd8e-0103fbbca8ff" alt="Table 9-3 show cdp Commands That List Information About Neighbors
Command
show cdp neigh-
bors [type number]
show cdp neigh-
bors detail
show cdp entry
name
Description
Lists one summary line of information about each
neighbor or just the neighbor found on a specific inter-
face if an interface was listed
Lists one large set (approximately 15 lines) of informa-
tion, one set for every neighbor
Lists the same information as the show cdp neighbors
detail command, but only for the named neighbor
(case sensitive)" class="lightbox-image" loading="lazy">
</a></p>
<p>routers and switches support the same CDP commands, with the same parameters and same types of output.</p>
<p>
<a href="#image-023eedd452931cbd41b2c6929057c687" class="lightbox-link">
<img src="blob:file:///65b036b9-4ce9-4ab5-abbf-e54bbaa228fb" alt="Cisco 2960XR Switches (WS-2960XR-24TS-l)
Gil/0/1
Fred
GilW24
SWI
Gil /0/2
Barney
02002222.2222
Gil,W21
Gil/O&#39;2
GiO,W1 0200.5555.5555
Cisco ISRIK Router
Figure 9-8 Small Network Used in CDP Examples" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-023eedd452931cbd41b2c6929057c687">
<img src="blob:file:///65b036b9-4ce9-4ab5-abbf-e54bbaa228fb" alt="Cisco 2960XR Switches (WS-2960XR-24TS-l)
Gil/0/1
Fred
GilW24
SWI
Gil /0/2
Barney
02002222.2222
Gil,W21
Gil/O&#39;2
GiO,W1 0200.5555.5555
Cisco ISRIK Router
Figure 9-8 Small Network Used in CDP Examples" class="lightbox-image" loading="lazy">
</a></p>
<p>Example 9-15 show cdp neighbors Command Examples: SW2<br>
Click here to view code image<br>
SW2# show cdp neighbors<br>
Capability Codes: R<br>
S<br>
D<br>
Router,</p>
<ul>
<li>Switch,<br>
Remote,<br>
T<br>
c<br>
Trans<br>
Host,<br>
CVTA,<br>
Bridge, B<br>
Source Route Bri<br>
1<br>
M<br>
IGMP, r<br>
Repeater, p<br>
Two-port Mac Relay<br>
Device ID<br>
SWI<br>
RI<br>
Local Intrfce<br>
Gig 1/0/21<br>
Gig 1/0/2<br>
Holdtme<br>
155<br>
131<br>
Capability<br>
Platform<br>
ws-C296ex<br>
Cili1-8P<br>
Total cdp entries displayed<br>
.2 &ldquo;&gt;</li>
</ul>
<p>To ensure all devices receive a CDP message, the Ethernet header uses a multicast destination MAC address (0100.0CCC.CCCC).</p>
<p>the device processes the message and then discards it, rather than forwarding it</p>
<p>show cdp neighbors detail</p>
<p>lists the full name of the switch model (WS-2960XR-24TS-I) and the IP address configured on the neighboring device.</p>
<p>
<a href="#image-c90a51b3cfbb22ccaca2fb6c84a1d19e" class="lightbox-link">
<img src="blob:file:///79b58992-46ce-4683-8122-3a240e3e3588" alt="SW2# show cdp neighbors detail
Device ID: SWI
Entry address(es):
IP address: 1.1.1.1
Platform: cisco WS-C2960XR-24TS-1,
Capabilities: Switch IGMP
Interface:
Holdtime .
Version :
GigabitEthernet1/0/21,
144 sec
Port ID (outgoing port):
GigabitE
Version
Cisco IOS Software, Software (C2960X-UNIVERSALK9-M),
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2018 by Cisco Systems, Inc.
Compiled Thu 13-Sep-18 03 by prod rel team" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-c90a51b3cfbb22ccaca2fb6c84a1d19e">
<img src="blob:file:///79b58992-46ce-4683-8122-3a240e3e3588" alt="SW2# show cdp neighbors detail
Device ID: SWI
Entry address(es):
IP address: 1.1.1.1
Platform: cisco WS-C2960XR-24TS-1,
Capabilities: Switch IGMP
Interface:
Holdtime .
Version :
GigabitEthernet1/0/21,
144 sec
Port ID (outgoing port):
GigabitE
Version
Cisco IOS Software, Software (C2960X-UNIVERSALK9-M),
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2018 by Cisco Systems, Inc.
Compiled Thu 13-Sep-18 03 by prod rel team" class="lightbox-image" loading="lazy">
</a></p>
<p>
<a href="#image-8443df1ebce084774f0b52f3ec5d3506" class="lightbox-link">
<img src="blob:file:///41b70243-659b-48eb-8a21-e4eeb14899e3" alt="advertisement version: 2
Protocol Hello: OUI=oxoeoooc,
VTP Management Domain: &amp;lsquo;fred&amp;rsquo;
Native VLAN: 1
Duplex: full
Management address(es) :
IP address: 1.1.1.1
Device ID: RI
Entry address(es):
IP address: 10.12.25.5
Protocol ID=oxØ112;
payload len=27,
Interface:
Holdtime .
Capabilities: Router Switch IGMP
Port ID (outgoing port): GigabitEt
GigabitEthernet1/0/2,
151 sec" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-8443df1ebce084774f0b52f3ec5d3506">
<img src="blob:file:///41b70243-659b-48eb-8a21-e4eeb14899e3" alt="advertisement version: 2
Protocol Hello: OUI=oxoeoooc,
VTP Management Domain: &amp;lsquo;fred&amp;rsquo;
Native VLAN: 1
Duplex: full
Management address(es) :
IP address: 1.1.1.1
Device ID: RI
Entry address(es):
IP address: 10.12.25.5
Protocol ID=oxØ112;
payload len=27,
Interface:
Holdtime .
Capabilities: Router Switch IGMP
Port ID (outgoing port): GigabitEt
GigabitEthernet1/0/2,
151 sec" class="lightbox-image" loading="lazy">
</a></p>
<p>
<a href="#image-ad0fef4388a83134a0c77362d7a90ddd" class="lightbox-link">
<img src="blob:file:///b8cc1ddc-e463-4ddf-9f81-4ecebf1796c2" alt="Version :
Cisco IOS Software [Fuji], ISR Software (ARMV8EB LINUX IOSD-UNIVERSA
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2018 by Cisco Systems, Inc.
Compiled Tue 27-Mar-18 10:56 by mcpre
advertisement version :
2
VTP Management Domain: &amp;rsquo; &amp;rsquo;
Duplex: full
Management address(es) :
IP address: 10.12.25.5
Total cdp entries displayed
.2" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-ad0fef4388a83134a0c77362d7a90ddd">
<img src="blob:file:///b8cc1ddc-e463-4ddf-9f81-4ecebf1796c2" alt="Version :
Cisco IOS Software [Fuji], ISR Software (ARMV8EB LINUX IOSD-UNIVERSA
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2018 by Cisco Systems, Inc.
Compiled Tue 27-Mar-18 10:56 by mcpre
advertisement version :
2
VTP Management Domain: &amp;rsquo; &amp;rsquo;
Duplex: full
Management address(es) :
IP address: 10.12.25.5
Total cdp entries displayed
.2" class="lightbox-image" loading="lazy">
</a></p>
<p>The show cdp entry name command lists the exact same details shown in the output of the show cdp neighbors detail command, but for only the one neighbor listed in the command.</p>
<p>Cisco recommends that CDP be disabled on any interface that might not have a need for CDP. For switches, any switch port connected to another switch, a router, or to an IP phone should use CDP.</p>
<h3 id="configuring-and-verifying-cdp">Configuring and Verifying CDP</h3>
<p>IOS typically enables CDP globally and on each interface by default. You can then disable CDP per interface with the no cdp enable interface subcommand</p>
<p>re-enable it with the cdp enable interface subcommand</p>
<p>disable and re-enable CDP globally on the device</p>
<p>no cdp run and cdp run global commands</p>
<p>
<a href="#image-4a644e0ff5579dd3b12bec9088918d7c" class="lightbox-link">
<img src="blob:file:///518b3cfe-18e1-4a81-9187-be7eea7b496b" alt="Table 9-4 Commands Used to Verify CDP Operations
Command
show cdp
show cdp inter-
face [type
number]
show cdp traffic
Description
States whether CDP is enabled globally and lists the de-
fault update and holdtime timers
States whether CDP is enabled on each interface, or a
single interface if the interface is listed, and states up-
date and holdtime timers on those interfaces
Lists global statistics for the number of CDP advertise-
ments sent and received" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-4a644e0ff5579dd3b12bec9088918d7c">
<img src="blob:file:///518b3cfe-18e1-4a81-9187-be7eea7b496b" alt="Table 9-4 Commands Used to Verify CDP Operations
Command
show cdp
show cdp inter-
face [type
number]
show cdp traffic
Description
States whether CDP is enabled globally and lists the de-
fault update and holdtime timers
States whether CDP is enabled on each interface, or a
single interface if the interface is listed, and states up-
date and holdtime timers on those interfaces
Lists global statistics for the number of CDP advertise-
ments sent and received" class="lightbox-image" loading="lazy">
</a></p>
<p>
<a href="#image-ef83984a112aa38193f0fe9f496d1a1b" class="lightbox-link">
<img src="blob:file:///7787792d-cb59-4452-b119-10c3deeda082" alt="Example 9-17 show cdp Commands That Show CDP Status
Click here to view code image
SW2# show cdp
Global CDP information:
Sending CDP packets every 60 seconds
Sending a holdtime value of 180 seconds
Sending CDPv2 advertisements is enabled
SW2# show cdp interface GigabitEthernet1/0/2
GigabitEthernet1/Ø/2 is up, line protocol is up
Encapsulation ARPA
Sending CDP packets every 60 seconds
Holdtime is 180 seconds
SW2# show cdp traffic
CDP counters :
Total packets
Hdr syntax: 0,
No memory: 0,
CDP version 1
CDP version 2
output: 304, Input: 305
Chksum error:
Invalid packet
advertisements
advertisements
0, Encaps failed
output :
output :
0, Input
304, Input: 305" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-ef83984a112aa38193f0fe9f496d1a1b">
<img src="blob:file:///7787792d-cb59-4452-b119-10c3deeda082" alt="Example 9-17 show cdp Commands That Show CDP Status
Click here to view code image
SW2# show cdp
Global CDP information:
Sending CDP packets every 60 seconds
Sending a holdtime value of 180 seconds
Sending CDPv2 advertisements is enabled
SW2# show cdp interface GigabitEthernet1/0/2
GigabitEthernet1/Ø/2 is up, line protocol is up
Encapsulation ARPA
Sending CDP packets every 60 seconds
Holdtime is 180 seconds
SW2# show cdp traffic
CDP counters :
Total packets
Hdr syntax: 0,
No memory: 0,
CDP version 1
CDP version 2
output: 304, Input: 305
Chksum error:
Invalid packet
advertisements
advertisements
0, Encaps failed
output :
output :
0, Input
304, Input: 305" class="lightbox-image" loading="lazy">
</a></p>
<p>send time and the hold time. CDP sends messages every 60 seconds by default, with a hold time of 180 seconds. The hold time tells the device how long to wait after no longer hearing from a device before removing those details from the CDP tables. You can override the defaults with the cdp timer seconds and cdp holdtime seconds global commands, respectively.</p>
<h2 id="examining-information-learned-by-lldp">Examining Information Learned by LLDP</h2>
<p>
<a href="#image-612325a8ae6942a0c8ca1beb9154b77f" class="lightbox-link">
<img src="blob:file:///c3dc6bd1-0f19-4496-9d7a-8b042e9acc13" alt="SW2# show Ildp neighbors
Capability codes:
(R) Router, (B) Bridge, (T) Telephone, (C) DOCSIS Cable Device
Hold-time
(W) WLAN Access Point, (P) Repeater,
(S)
Station, (O) Other
Device ID
RI
SWI
Local Intf
Gil/O/2
Gil /0/21
Capability
120
120
Trans
Host,
CVTA,
Port
GiO/O/
Gil/Oj
Total entries displayed: 2
SW2# show cdp neighbors
Capability Codes: R
S
D
Router,
Switch,
Remote,
T
c
Bridge, B
Source Route Bri
1
IGMP, r
Repeater, p
M - Two-port Mac
Device ID
Local Intrfce
Gig 1/0/21
Gig 1/0/2
displayed: 2
Holdtme
155
131
Capability
SWI
RI
Total
Relay
Platform
ws-C296ex
Cili1-8P
entries" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-612325a8ae6942a0c8ca1beb9154b77f">
<img src="blob:file:///c3dc6bd1-0f19-4496-9d7a-8b042e9acc13" alt="SW2# show Ildp neighbors
Capability codes:
(R) Router, (B) Bridge, (T) Telephone, (C) DOCSIS Cable Device
Hold-time
(W) WLAN Access Point, (P) Repeater,
(S)
Station, (O) Other
Device ID
RI
SWI
Local Intf
Gil/O/2
Gil /0/21
Capability
120
120
Trans
Host,
CVTA,
Port
GiO/O/
Gil/Oj
Total entries displayed: 2
SW2# show cdp neighbors
Capability Codes: R
S
D
Router,
Switch,
Remote,
T
c
Bridge, B
Source Route Bri
1
IGMP, r
Repeater, p
M - Two-port Mac
Device ID
Local Intrfce
Gig 1/0/21
Gig 1/0/2
displayed: 2
Holdtme
155
131
Capability
SWI
RI
Total
Relay
Platform
ws-C296ex
Cili1-8P
entries" class="lightbox-image" loading="lazy">
</a></p>
<p>the LLDP output in the example does differ from CDP in a few important ways:</p>
<p>LLDP uses B as the capability code for switching, referring to bridge, a term for the device type that existed before switches that performed the same basic functions.</p>
<p>LLDP does not identify IGMP as a capability, while CDP does (I).</p>
<p>CDP lists the neighbor’s platform, a code that defines the device type, while LLDP does not.</p>
<p>LLDP lists capabilities with different conventions (see upcoming Example 9-19).</p>
<p>
<a href="#image-14efd182f37c279337c964fcdb357ea1" class="lightbox-link">
<img src="blob:file:///947e4912-5bcb-4289-be21-d45a96066b85" alt="SW2# show Ildp entry RI
Capability codes:
(R) Router, (B) Bridge, (T) Telephone, (C) DOCSIS Cable Device
(W) WLAN Access Point, (P) Repeater, (S) Station, (O) Other
Local Intf: Gil/0/2
Chassis id: 70ea .1a9a.d3Ø0
Port id: GiØ/0/1
Port Description: GigabitEthernet0/Ø/1
System Name: RI
System Description:
Cisco IOS Software [Fuji], ISR Software (ARMV8EB LINUX IOSD-UNIVERSA
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2018 by Cisco Systems, Inc.
Compiled Tue 27-Mar-18 10:56 by mcpre
Time remaining: 100 seconds
System Capabilities: B,R
Enabled Capabilities: R
Management Addresses :
IP: 10.12.25.5
Auto Negotiation
not supported
Physical media capabilities
not advertised
Media Attachment Unit type
not advertised
Vlan ID:
not advertised" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-14efd182f37c279337c964fcdb357ea1">
<img src="blob:file:///947e4912-5bcb-4289-be21-d45a96066b85" alt="SW2# show Ildp entry RI
Capability codes:
(R) Router, (B) Bridge, (T) Telephone, (C) DOCSIS Cable Device
(W) WLAN Access Point, (P) Repeater, (S) Station, (O) Other
Local Intf: Gil/0/2
Chassis id: 70ea .1a9a.d3Ø0
Port id: GiØ/0/1
Port Description: GigabitEthernet0/Ø/1
System Name: RI
System Description:
Cisco IOS Software [Fuji], ISR Software (ARMV8EB LINUX IOSD-UNIVERSA
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2018 by Cisco Systems, Inc.
Compiled Tue 27-Mar-18 10:56 by mcpre
Time remaining: 100 seconds
System Capabilities: B,R
Enabled Capabilities: R
Management Addresses :
IP: 10.12.25.5
Auto Negotiation
not supported
Physical media capabilities
not advertised
Media Attachment Unit type
not advertised
Vlan ID:
not advertised" class="lightbox-image" loading="lazy">
</a></p>
<p>System Capabilities: What the device can do</p>
<p>Enabled Capabilities: What the device does now with its current configuration</p>
<p>LLDP uses the same messaging concepts as CDP, encapsulating messages directly in data-link headers. Devices do not forward LLDP messages so that LLDP learns only of directly connected neighbors. LLDP does use a different multicast MAC address (0180.C200.000E)</p>
<h3 id="configuring-and-verifying-lldp">Configuring and Verifying LLDP</h3>
<p>Cisco devices default to disable LLDP</p>
<p>LLDP separates the sending and receiving of LLDP messages as separate functions.</p>
<p>LLDP support processing receives LLDP messages on an interface so that the switch or router learns about the neighboring device while not transmitting LLDP messages to the neighboring device.</p>
<p>the commands include options to toggle on|off the transmission of LLDP messages separately from the processing of received messages.</p>
<p>[no] lldp run: A global configuration command that sets the default mode of LLDP operation for any interface that does not have more specific LLDP subcommands (lldp transmit, lldp receive). The lldp run global command enables LLDP in both directions on those interfaces, while no lldp run disables LLDP.</p>
<p>[no] lldp transmit: An interface sub-command that defines the operation of LLDP on the interface regardless of the global [no] lldp run command. The lldp transmit interface subcommand causes the device to transmit LLDP messages, while no lldp transmit causes it to not transmit LLDP messages.</p>
<p>[no] lldp receive: An interface subcommand that defines the operation of LLDP on the interface regardless of the global [no] lldp run command. The lldp receive interface subcommand causes the device to process received LLDP messages, while no lldp receive causes it to not process received LLDP messages.</p>
<p>
<a href="#image-85d837ce4190c09fd197605c5efe9269" class="lightbox-link">
<img src="blob:file:///48b49040-6e65-45ee-a590-a3b5e0fcc11b" alt="Example 9-20 Enabling LLDP on All Ports, Disabling on a Few Ports
Click here to view code image
lldp run
interface gigabitEthernet1/Ø/17
no lldp transmit
no lldp receive
interface gigabitEthernet1/Ø/18
no lldp receive" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-85d837ce4190c09fd197605c5efe9269">
<img src="blob:file:///48b49040-6e65-45ee-a590-a3b5e0fcc11b" alt="Example 9-20 Enabling LLDP on All Ports, Disabling on a Few Ports
Click here to view code image
lldp run
interface gigabitEthernet1/Ø/17
no lldp transmit
no lldp receive
interface gigabitEthernet1/Ø/18
no lldp receive" class="lightbox-image" loading="lazy">
</a></p>
<p>
<a href="#image-a0117dca0daabae3650daeb33775fa55" class="lightbox-link">
<img src="blob:file:///7640bbe6-77fa-41fe-97a7-8d5fd4d05b6e" alt="Example 9-21 Enabling LLDP on Limited Ports, Leaving Disabled on Most
Click here to view code image
interface gigabitEthernet1/Ø/19
lldp transmit
lldp receive
interface gigabitEthernet1/0/20
lldp receive" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-a0117dca0daabae3650daeb33775fa55">
<img src="blob:file:///7640bbe6-77fa-41fe-97a7-8d5fd4d05b6e" alt="Example 9-21 Enabling LLDP on Limited Ports, Leaving Disabled on Most
Click here to view code image
interface gigabitEthernet1/Ø/19
lldp transmit
lldp receive
interface gigabitEthernet1/0/20
lldp receive" class="lightbox-image" loading="lazy">
</a></p>
<p>show lldp interface lists the interfaces on which LLDP is enabled.</p>
<p>
<a href="#image-b7351dbe6d8ecde4ca70228b6748b0c8" class="lightbox-link">
<img src="blob:file:///56b09a3a-ac43-4d2d-9691-279d8f24afdb" alt="SW2# show Ildp
Global LLDP Information:
status: ACTIVE
LLDP advertisements are sent every 30 seconds
LLDP hold time advertised is 120 seconds
LLDP interface reinitialisation delay is 2 seconds
SW2# show Ildp interface gl/Ø/2
GigabitEthernet1/Ø/2:
Tx: enabled
Rx: enabled
Tx state: IDLE
Rx state: WAIT FOR FRAME
SW2# show Ildp traffic
LLDP traffic statistics:
Total
Total
Total
Total
Total
Total
Total
frames out: 259
entries aged: 0
frames in: 257
frames received in error
frames discarded: 0
TLVs discarded: 0
TLVs unrecognized: 0" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-b7351dbe6d8ecde4ca70228b6748b0c8">
<img src="blob:file:///56b09a3a-ac43-4d2d-9691-279d8f24afdb" alt="SW2# show Ildp
Global LLDP Information:
status: ACTIVE
LLDP advertisements are sent every 30 seconds
LLDP hold time advertised is 120 seconds
LLDP interface reinitialisation delay is 2 seconds
SW2# show Ildp interface gl/Ø/2
GigabitEthernet1/Ø/2:
Tx: enabled
Rx: enabled
Tx state: IDLE
Rx state: WAIT FOR FRAME
SW2# show Ildp traffic
LLDP traffic statistics:
Total
Total
Total
Total
Total
Total
Total
frames out: 259
entries aged: 0
frames in: 257
frames received in error
frames discarded: 0
TLVs discarded: 0
TLVs unrecognized: 0" class="lightbox-image" loading="lazy">
</a></p>
<p>like CDP, LLDP uses a send timer and hold timer for the same purposes as CDP. The example shows the default settings of 30 seconds for the send timer and 120 seconds for the hold timer. You can override the defaults with the lldp timer seconds and lldp holdtime seconds global commands</p>

            <footer class="footline">

            </footer>
          </article>

        </div>
      </main>
    </div>
    <script src="/js/clipboard.min.js?1700252831" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1700252831" defer></script>
    <script>
      function useMathJax( config ){
        if( !Object.assign ){
          
          return;
        }
        window.MathJax = Object.assign( window.MathJax || {}, {
          loader: {
            load: ['[tex]/mhchem']
          },
          startup: {
            elements: [
              '.math'
            ]
          },
          tex: {
            inlineMath: [
              ['$', '$'], 
              ['\\(', '\\)']
            ]
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/js/d3/d3-color.min.js?1700252831" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1700252831" defer></script>
    <script src="/js/d3/d3-drag.min.js?1700252831" defer></script>
    <script src="/js/d3/d3-ease.min.js?1700252831" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1700252831" defer></script>
    <script src="/js/d3/d3-selection.min.js?1700252831" defer></script>
    <script src="/js/d3/d3-timer.min.js?1700252831" defer></script>
    <script src="/js/d3/d3-transition.min.js?1700252831" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1700252831" defer></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{ \"theme\": \"default\" }");
    </script>
    <script src="/js/theme.js?1700252831" defer></script>
  </body>
</html>
